<%- include('../partials/header') %>

    <main class="container">

        <!-- SEARCH CONTEXT -->
        <section class="info-box">
            <h2>Search Results</h2>

            <% if (query) { %>
                <ul class="info-list">
                    <li>
                        üîç Results for:
                        <strong style="color:#fff;">
                            <%= query %>
                        </strong>
                    </li>
                    <li>
                        üìÑ Results on this page:
                        <strong style="color:#fff;">
                            <%= results.length %>
                        </strong>
                    </li>
                </ul>
                <% } %>
        </section>

        <!-- RESULTS -->
        <% if (results && results.length> 0) { %>

            <section class="category-section">

                <div class="links-wrapper">

                    <% results.forEach(link=> { %>
                        <article class="link-card">

                            <div class="link-left">
                                <h3>
                                    <%= link.title %>
                                </h3>

                                <div class="link-meta">

                                    <span class="meta-item">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="3" y="4" width="18" height="18" rx="2"></rect>
                                            <line x1="16" y1="2" x2="16" y2="6"></line>
                                            <line x1="8" y1="2" x2="8" y2="6"></line>
                                            <line x1="3" y1="10" x2="21" y2="10"></line>
                                        </svg>
                                        <%= new Date(link.createdAt).toLocaleDateString('en-GB') %>
                                    </span>

                                    <span class="meta-item">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <circle cx="12" cy="12" r="10"></circle>
                                            <polyline points="12 6 12 12 16 14"></polyline>
                                        </svg>
                                        <%= new Date(link.createdAt).toLocaleTimeString('en-US', { hour: '2-digit' ,
                                            minute: '2-digit' , hour12: true }) %>
                                    </span>

                                    <span class="meta-item">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round">
                                            <path
                                                d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z">
                                            </path>
                                            <line x1="7" y1="7" x2="7.01" y2="7"></line>
                                        </svg>
                                        <%= link.category %>
                                    </span>

                                </div>
                            </div>

                            <a class="visit-btn mega-style" href="/go/<%= link._id %>">

                                <svg class="mega-logo" viewBox="0 0 24 24" fill="currentColor">
                                    <path
                                        d="M12 0C5.372 0 0 5.372 0 12s5.372 12 12 12 12-5.372 12-12S18.628 0 12 0zm6.23 16.244a.371.371 0 0 1-.373.372H16.29a.371.371 0 0 1-.372-.372v-4.828c0-.04-.046-.06-.08-.033l-3.32 3.32a.742.742 0 0 1-1.043 0l-3.32-3.32c-.027-.027-.08-.007-.08.033v4.828a.371.371 0 0 1-.372.372H6.136a.371.371 0 0 1-.372-.372V7.757c0-.206.166-.372.372-.372h1.076a.75.75 0 0 1 .525.22l4.13 4.13a.18.18 0 0 0 .26 0l4.13-4.13c.14-.14.325-.22.525-.22h1.075c.206 0 .372.166.372.372z">
                                    </path>

                                </svg>

                                <span>Visit Mega Link</span>

                                <svg class="arrow-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M14 5l7 7m0 0l-7 7m7-7H3">
                                    </path>
                                </svg>

                            </a>

                        </article>
                        <% }) %>

                </div>
            </section>

            <% if (totalPages && totalPages> 1) { %>
                <nav class="pagination-container" aria-label="Page navigation">
                    <div class="pagination-wrapper">

                        <% if (page> 1) { %>
                            <a href="?q=<%= query %>&page=<%= page - 1 %>" class="pag-btn prev-next">
                                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15 19l-7-7 7-7"></path>
                                </svg>
                                <span>Prev</span>
                            </a>
                            <% } else { %>
                                <span class="pag-btn prev-next disabled">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M15 19l-7-7 7-7"></path>
                                    </svg>
                                    <span>Prev</span>
                                </span>
                                <% } %>

                                    <div class="page-counter">
                                        <span class="current-page">
                                            <%= page %>
                                        </span>
                                        <span class="sep">/</span>
                                        <span class="total-pages">
                                            <%= totalPages %>
                                        </span>
                                    </div>

                                    <% if (page < totalPages) { %>
                                        <a href="?q=<%= query %>&page=<%= page + 1 %>" class="pag-btn prev-next">
                                            <span>Next</span>
                                            <svg width="20" height="20" fill="none" stroke="currentColor"
                                                viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M9 5l7 7-7 7"></path>
                                            </svg>
                                        </a>
                                        <% } else { %>
                                            <span class="pag-btn prev-next disabled">
                                                <span>Next</span>
                                                <svg width="20" height="20" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2" d="M9 5l7 7-7 7"></path>
                                                </svg>
                                            </span>
                                            <% } %>

                    </div>
                </nav>
                <% } %>

                    <% } else { %>

                        <!-- NO RESULTS -->
                        <section class="info-box">
                            <ul class="info-list">
                                <li>‚ùå No results found</li>
                                <li>üí° Try different keywords or category filters</li>
                            </ul>
                        </section>

                        <% } %>

    </main>

    <%- include('../partials/footer') %>